import{d as C,r as x,g as V,a,c as $,o as d,b as _,e as c,w as o,f as i,t as p,p as P,_ as y,h as D,i as I,j as B,k as m,m as T,V as w,l as L}from"./index-oCDbjsqw.js";const z={class:"services-group"},E={class:"right-item"},q={class:"right-item"},H=C({__name:"ButtonSuffix",setup(S){const r=x(""),g=x([]),l=x({status:"info",content:"未启动",icon:"vxe-icon-caret-right",running:"stop"});function f(e){switch(e){case"running":l.value={status:"danger",content:"运行中...",icon:"vxe-icon-checkbox-unchecked-fill",running:e};break;default:l.value={status:"info",content:"未启动",icon:"vxe-icon-caret-right",running:e}}}V().then(e=>{const t=[];e.data.ifaces.forEach(s=>{t.push({label:s.name,value:s.name})}),g.value=t,r.value=e.data?.iface,f(e.data.running)});const h=({option:e})=>{r.value=e.value},b=()=>{P(l.value.running,r.value).then(e=>{f(e.data.running)})};return(e,t)=>{const s=a("vxe-text"),u=a("vxe-icon"),v=a("vxe-pulldown"),k=a("vxe-button");return d(),$("div",z,[_("span",E,[t[0]||(t[0]=_("span",{class:"right-item-title"},"代理网卡：",-1)),c(v,{options:g.value,trigger:"click",class:"right-item-comp","show-popup-shadow":"",transfer:"",onOptionClick:h},{default:o(()=>[c(s,null,{default:o(()=>[i(p(r.value),1)]),_:1}),c(u,{name:"caret-down"})]),_:1},8,["options"])]),_("span",q,[t[1]||(t[1]=_("span",{class:"right-item-title"},"服务状态：",-1)),c(k,{onClick:b,"class-name":"service-status-btn",mode:"text",status:l.value.status,"prefix-icon":l.value.icon,content:l.value.content},null,8,["status","prefix-icon","content"])])])}}}),N=y(H,[["__scopeId","data-v-daad80dc"]]),j=C({__name:"DnsList",setup(S){const r=x(),f=D({id:"DnsList",height:"100%",stripe:!0,keepSource:!0,showOverflow:!0,rowConfig:{isHover:!0},sortConfig:{remote:!0,multiple:!0},editConfig:{mode:"row",showStatus:!0,trigger:"dblclick"},editRules:{name:[{required:!0,message:"请输入名称"}]},customConfig:{storage:!0},toolbarConfig:{refresh:!0,zoom:!0,slots:{buttonSuffix:"buttonSuffix",buttonPrefix:"buttonPrefix"},buttons:[{size:"medium",name:"标记/删除",code:"mark_cancel",status:"error",icon:"vxe-icon-delete"},{size:"medium",name:"保存",code:"save",status:"success",icon:"vxe-icon-save"}]},pagerConfig:{enabled:!1},columns:[{type:"checkbox",width:60},{type:"seq",width:60},{field:"protocol",title:"HTTP协议",sortable:!0,width:110,cellRender:{name:"VxeSwitch",props:{size:"mini",openLabel:"HTTPS",closeLabel:"HTTP",openValue:"https",closeValue:"http",class:"protocol-switch"}}},{field:"domain",title:"本地映射域名",sortable:!0,width:300,slots:{default:"domain"},editRender:{name:"VxeInput"}},{field:"ip",title:"映射IP",sortable:!0,width:150,editRender:{name:"VxeInput"}},{field:"port",title:"映射端口",sortable:!0,width:120,editRender:{name:"VxeInput"}},{field:"status",title:"启用状态",sortable:!0,width:110,align:"center",cellRender:{name:"VxeSwitch",props:{size:"mini",openLabel:"启用",closeLabel:"停用",openValue:1,closeValue:0}}},{field:"description",title:"描述",minWidth:200,slots:{default:"description"}},{field:"updatedAt",title:"更新时间",width:160,formatter:"FormatDateTime",sortable:!0},{field:"createdAt",title:"创建时间",width:160,formatter:"FormatDateTime",sortable:!0},{field:"action",title:"操作",width:160,slots:{default:"action"}}],proxyConfig:{form:!1,sort:!0,ajax:{query({sorts:e}){const t={orderBy:e.map(s=>`${s.field}|${s.order}`).join(",")};return B(t)},save({body:e}){return I({...e})}}}}),h=async e=>{const t=r.value;if(t&&t.isInsertByRow(e)){t.remove(e);return}await w.modal.confirm({content:`请确认是否删除 “ ${e.domain} ”？`})==="confirm"&&L({id:e.id}).then(u=>{t&&t.commitProxy("query"),w.modal.message({content:u.message,status:"success"})})},b=async()=>{const e=r.value;if(e){const{row:t}=await e.insert({protocol:"http",ip:"127.0.0.1",port:80,status:1});e.setEditRow(t,"domain")}};return(e,t)=>{const s=a("vxe-button"),u=a("vxe-link"),v=a("vxe-text"),k=a("vxe-grid"),R=a("PageView");return d(),m(R,null,{default:o(()=>[c(k,T({ref_key:"gridRef",ref:r},f),{buttonPrefix:o(()=>[c(s,{size:"medium",status:"primary",icon:"vxe-icon-add",onClick:b},{default:o(()=>[...t[0]||(t[0]=[i("新增",-1)])]),_:1})]),buttonSuffix:o(()=>[c(N)]),domain:o(({row:n})=>[n.status===1?(d(),m(u,{key:0,href:`${n.protocol}://${n.domain}:${n.port}`,target:"_blank"},{default:o(()=>[i(p(n.domain),1)]),_:2},1032,["href"])):(d(),m(v,{key:1},{default:o(()=>[i(p(n.domain),1)]),_:2},1024))]),description:o(({row:n})=>[t[1]||(t[1]=i(" 本地域名 ",-1)),n.status===1?(d(),m(u,{key:0,href:`${n.protocol}://${n.domain}:${n.port}`,target:"_blank"},{default:o(()=>[i(p(n.domain),1)]),_:2},1032,["href"])):(d(),m(v,{key:1},{default:o(()=>[i(p(n.domain),1)]),_:2},1024)),i(" 映射到 "+p(n.ip),1)]),action:o(({row:n})=>[c(s,{mode:"text",status:"error",icon:"vxe-icon-delete",onClick:O=>h(n)},{default:o(()=>[...t[2]||(t[2]=[i("删除",-1)])]),_:1},8,["onClick"])]),_:1},16)]),_:1})}}}),F=y(j,[["__scopeId","data-v-71c23a0d"]]);export{F as default};
